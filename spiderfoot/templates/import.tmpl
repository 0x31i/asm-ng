<%include file="HEADER.tmpl"/>
<script>document.write('<script type="text/javascript" src="${docroot}/static/js/spiderfoot.import.js?v=' + Date.now() + '"><\/script>');</script>
<h2>Import Data</h2>
<p class="text-muted" style="margin-bottom: 25px;">Import scan data from various sources into ASM-NG.</p>

<div class="row import-cards-row">

  <!-- Legacy Scan Import (CSV) -->
  <div class="col-sm-6 col-md-3">
    <div class="import-card" id="card-legacy" data-import-type="legacy">
      <div class="import-card-icon">
        <i class="glyphicon glyphicon-file"></i>
      </div>
      <h4 class="import-card-title">Legacy Scan</h4>
      <p class="import-card-desc">Import CSV exports from older SpiderFoot versions.</p>
      <span class="import-card-filetype">.csv</span>
    </div>
  </div>

  <!-- SpiderFoot Scan Import (backup/restore) -->
  <div class="col-sm-6 col-md-3">
    <div class="import-card" id="card-scan" data-import-type="scan">
      <div class="import-card-icon">
        <i class="glyphicon glyphicon-refresh"></i>
      </div>
      <h4 class="import-card-title">Scan Backup</h4>
      <p class="import-card-desc">Restore scans from SpiderFoot CSV backups.</p>
      <span class="import-card-filetype">.csv</span>
    </div>
  </div>

  <!-- Burp Suite Import (placeholder) -->
  <div class="col-sm-6 col-md-3">
    <div class="import-card import-card-disabled" id="card-burp" data-import-type="burp">
      <div class="import-card-icon">
        <i class="glyphicon glyphicon-globe"></i>
      </div>
      <h4 class="import-card-title">Burp Suite</h4>
      <p class="import-card-desc">Import findings from Burp Suite XML exports.</p>
      <span class="import-card-filetype">.xml</span>
      <span class="import-card-badge">Coming Soon</span>
    </div>
  </div>

  <!-- Nessus Pro Import (placeholder) -->
  <div class="col-sm-6 col-md-3">
    <div class="import-card import-card-disabled" id="card-nessus" data-import-type="nessus">
      <div class="import-card-icon">
        <i class="glyphicon glyphicon-shield"></i>
      </div>
      <h4 class="import-card-title">Nessus Pro</h4>
      <p class="import-card-desc">Import vulnerability data from Nessus exports.</p>
      <span class="import-card-filetype">.nessus</span>
      <span class="import-card-badge">Coming Soon</span>
    </div>
  </div>

</div>

<!-- Import Form (hidden by default, shown when a card is selected) -->
<div id="import-form-section" style="display: none;">
  <hr>
  <h3 id="import-form-title">Import</h3>
  <form id="import-form" enctype="multipart/form-data">
    <input type="hidden" id="import-type" name="import_type" value="">

    <div class="row">
      <div class="col-sm-6">
        <div class="form-group">
          <label for="import-file">Select File</label>
          <input type="file" class="form-control" id="import-file" name="importfile" accept=".csv">
          <small class="form-text text-muted" id="import-file-hint">Accepted format: CSV</small>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-4">
        <div class="form-group">
          <label for="import-scan-name">Scan Name <small class="text-muted">(optional)</small></label>
          <input type="text" class="form-control" id="import-scan-name" name="scan_name" placeholder="Auto-generated from filename if blank">
        </div>
      </div>
      <div class="col-sm-4">
        <div class="form-group">
          <label for="import-target">Target <small class="text-muted">(optional)</small></label>
          <input type="text" class="form-control" id="import-target" name="target" placeholder="Auto-detected from data if blank">
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12">
        <div class="checkbox">
          <label>
            <input type="checkbox" id="import-dry-run" name="dry_run" value="1">
            <strong>Dry Run</strong> &mdash; Validate the file without importing (preview only)
          </label>
        </div>
      </div>
    </div>

    <div class="row" style="margin-top: 15px;">
      <div class="col-sm-12">
        <button type="submit" class="btn btn-danger" id="btn-import">
          <i class="glyphicon glyphicon-import"></i> Import
        </button>
        <button type="button" class="btn btn-default" id="btn-import-cancel" style="margin-left: 10px;">
          Cancel
        </button>
      </div>
    </div>
  </form>
</div>

<!-- Results section (shown after import) -->
<div id="import-results-section" style="display: none;">
  <hr>
  <h3 id="import-results-title">Import Results</h3>
  <div id="import-results-content"></div>
</div>

<%include file="FOOTER.tmpl"/>
